---
id: 67279fe50237291f80eed8b8
title: 构建客户投诉表单
challengeType: 25
dashedName: build-a-customer-complaint-form
demoType: onClick
---

# --description--

对于这个实验，你已经获得了所有的HTML和CSS。你将使用JavaScript来验证投诉表单。

**目标：** 实现以下用户需求并通过所有测试以完成实验。

**用户需求：**

1. 当表单提交时，你应该确保：
    - `#full-name` 不为空。
    - `#email` 是有效的电子邮件地址格式。
    - `#order-no` 是以 `2024` 开头的十位数字序列。
    - `#product-code` 遵循模式 `XX##-X###-XX#`，其中 `X` 代表小写字母或大写字母，`#` 代表数字。
    - `#quantity` 是正整数。
    - `#complaints-group` 中至少有一个复选框被选中。
    - 如果选中了 `Other` 复选框，`#complaint-description` 至少包含二十个字符。
    - `#solutions-group` 中选中了一个单选按钮。
    - 如果选中了 `Other` 单选按钮，`#solution-description` 至少包含二十个字符。
1. 你应该有一个名为 `validateForm` 的函数，该函数返回一个包含以下键的对象：`full-name`、`email`、`order-no`、`product-code`、`quantity`、`complaints-group`、`complaint-description`、`solutions-group` 和 `solution-description`。如果对应的表单字段填写正确，每个键的值应该是 `true`，否则为 `false`。
1. 你应该有一个名为 `isValid` 的函数，该函数以 `validateForm` 返回的对象作为参数，如果每个表单字段都填写正确则返回 `true`，否则返回 `false`。
1. 如果在表单字段上触发了更改事件并且它具有有效值，你应该将其边框颜色设置为 `green`。对于复选框和单选按钮组，你应该设置父级 `fieldset` 的边框颜色。
1. 如果在表单字段上触发了更改事件并且它具有无效值，你应该将其边框颜色设置为 `red`。对于复选框和单选按钮组，你应该设置父级 `fieldset` 的边框颜色。
1. 当你尝试提交表单时，你应该调用 `isValid` 来验证表单。
1. 当你尝试提交表单时，如果表单有任何无效字段，每个无效字段都应该通过将每个无效输入、文本区域或字段集（对于复选框和单选按钮组）的边框颜色设置为 `red` 来突出显示。

# --hints--

你应该有一个名为 `validateForm` 的函数。

```js
assert.isFunction(validateForm);
```

`validateForm` 应该返回一个对象。

```js
assert.isObject(validateForm());
```

当 `#full-name` 为空时，`validateForm()["full-name"]` 应该是 `false`，否则为 `true`。

```js
const field = document.getElementById("full-name");
field.value = "";
assert.isFalse(validateForm()["full-name"]);
field.value = "testing";
assert.isTrue(validateForm()["full-name"]);
```

当在 `#full-name` 上触发 `change` 事件时，如果它包含有效值，你应该将其边框颜色设置为 `green`，否则设置为 `red`。

```js
const field = document.getElementById("full-name");
field.value = "testing"
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "green");
field.value = ""
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "red");
```

当 `#email` 包含有效的电子邮件地址时，`validateForm()["email"]` 应该是 `true`，否则为 `false`。

```js
const field = document.getElementById("email");
field.value = "example@domain.com"
assert.isTrue(validateForm()["email"]);
field.value = "testing"
assert.isFalse(validateForm()["email"]);
```

当在 `#email` 上触发 `change` 事件时，如果它包含有效的电子邮件地址，你应该将其边框颜色设置为 `green`，否则设置为 `red`。

```js
const field = document.getElementById("email");
field.value = "example@domain.com"
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "green");
field.value = ""
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "red");
```

当 `#order-no` 包含有效值时，`validateForm()["order-no"]` 应该是 `true`，否则为 `false`。

```js
const field = document.getElementById("order-no");
field.value = "2024001122"
assert.isTrue(validateForm()["order-no"]);
field.value = "testing"
assert.isFalse(validateForm()["order-no"]);
```

当在 `#order-no` 上触发 `change` 事件时，如果它包含有效值，你应该将其边框颜色设置为 `green`，否则设置为 `red`。

```js
const field = document.getElementById("order-no");
field.value = "2024001122"
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "green");
field.value = "20240011"
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "red");
```

当 `#product-code` 包含有效值时，`validateForm()["product-code"]` 应该是 `true`，否则为 `false`。

```js
const field = document.getElementById("product-code");
field.value = "Xa22-X123-Xb4";
assert.isTrue(validateForm()["product-code"]);
field.value = "testing"
assert.isFalse(validateForm()["product-code"]);
```

当在 `#product-code` 上触发 `change` 事件时，如果它包含有效值，你应该将其边框颜色设置为 `green`，否则设置为 `red`。

```js
const field = document.getElementById("product-code");
field.value = "Xa22-X123-Xb4"
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "green");
field.value = "Xa22-123-Xb4"
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "red");
```

当 `#quantity` 包含有效值时，`validateForm()["quantity"]` 应该是 `true`，否则为 `false`。

```js
const field = document.getElementById("quantity");
field.value = "5";
assert.isTrue(validateForm()["quantity"]);
field.value = "0";
assert.isFalse(validateForm()["quantity"]);
```

当在 `#quantity` 上触发 `change` 事件时，如果它包含有效值，你应该将其边框颜色设置为 `green`，否则设置为 `red`。

```js
const field = document.getElementById("quantity");
field.value = "2"
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "green");
field.value = "0"
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "red");
```

当 `#complaints-group` 中至少有一个复选框被选中时，`validateForm()["complaints-group"]` 应该是 `true`。

```js
document.getElementById("damaged-product").checked = true
assert.isTrue(validateForm()["complaints-group"]);
```

当 `#complaints-group` 中没有复选框被选中时，`validateForm()["complaints-group"]` 应该是 `false`。

```js
document.getElementById("damaged-product").checked = false;
document.getElementById("nonconforming-product").checked = false;
document.getElementById("delayed-dispatch").checked = false;
document.getElementById("other-complaint").checked = false;
assert.isFalse(validateForm()["complaints-group"]);
```

一旦 `#complaints-group` 中的一个复选框被选中，你应该将 `#complaints-group` 的边框颜色设置为 `green`。

```js
document.getElementById("nonconforming-product").checked = false;
document.getElementById("delayed-dispatch").checked = false;
document.getElementById("other-complaint").checked = false;
const damagedProduct = document.getElementById("damaged-product");
damagedProduct.checked = true;
damagedProduct.dispatchEvent(new Event("change", { bubbles: true }));
const fieldset = document.getElementById("complaints-group");
assert.equal(fieldset.style.borderColor, "green");
```

当 `#complaints-group` 中的所有复选框都更改为未选中状态时，你应该将 `#complaints-group` 的边框颜色设置为 `red`。

```js
document.getElementById("damaged-product").checked = false;
document.getElementById("delayed-dispatch").checked = false;
document.getElementById("other-complaint").checked = false;
const nonConfProduct = document.getElementById("nonconforming-product");
nonConfProduct.checked = false;
nonConfProduct.dispatchEvent(new Event("change", { bubbles: true }));
const fieldset = document.getElementById("complaints-group");
assert.equal(fieldset.style.borderColor, "red");
```

当 `#other-complaint` 被选中且 `#complaint-description` 包含至少二十个字符时，`validateForm()["complaint-description"]` 应该是 `true`。

```js
document.getElementById("other-complaint").checked = true
document.getElementById("complaint-description").value = "A sentence with at least twenty characters";
assert.isTrue(validateForm()["complaint-description"]);
```

当 `#other-complaint` 被选中且 `#complaint-description` 包含少于二十个字符时，`validateForm()["complaint-description"]` 应该是 `false`。

```js
document.getElementById("other-complaint").checked = true
document.getElementById("complaint-description").value = "Less than 20 chars";
assert.isFalse(validateForm()["complaint-description"]);
```

当 `#other-complaint` 被选中且 `#complaint-description` 的值更改为有效值时，你应该将其边框颜色设置为 `green`。

```js
document.getElementById("other-complaint").checked = true;
const field = document.getElementById("complaint-description");
field.value = "A sentence with at least twenty characters"
field.dispatchEvent(new Event("input", { bubbles: true }));
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "green");
```

当 `#other-complaint` 被选中且 `#complaint-description` 的值更改为无效值时，你应该将其边框颜色设置为 `red`。

```js
document.getElementById("other-complaint").checked = true;
const field = document.getElementById("complaint-description");
field.value = "Not enough chars"
field.dispatchEvent(new Event("input", { bubbles: true }));
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "red");
```

当 `#solutions-group` 中的一个单选按钮被选中时，`validateForm()["solutions-group"]` 应该是 `true`。

```js
document.getElementById("refund").checked = true
assert.isTrue(validateForm()["solutions-group"]);
```

当 `#solutions-group` 中没有单选按钮被选中时，`validateForm()["solutions-group"]` 应该是 `false`。

```js
document.getElementById("refund").checked = false;
document.getElementById("exchange").checked = false;
document.getElementById("other-solution").checked = false;
assert.isFalse(validateForm()["solutions-group"]);
```

一旦 `#solutions-group` 中的一个单选按钮被选中，你应该将 `#solutions-group` 的边框颜色设置为 `green`。

```js
document.getElementById("exchange").checked = false;
document.getElementById("other-solution").checked = false;
const refundRadioBtn = document.getElementById("refund");
refundRadioBtn.checked = true;
refundRadioBtn.dispatchEvent(new Event("change", { bubbles: true }));
const fieldset = document.getElementById("solutions-group");
assert.equal(fieldset.style.borderColor, "green");
```

当 `#solutions-group` 中的所有单选按钮在更改事件后都处于未选中状态时，你应该将 `#solutions-group` 的边框颜色设置为 `red`。

```js
document.getElementById("refund").checked = false;
document.getElementById("other-solution").checked = false;
const exchangeRadioBtn = document.getElementById("exchange");
exchangeRadioBtn.checked = false;
exchangeRadioBtn.dispatchEvent(new Event("change", { bubbles: true }));
const fieldset = document.getElementById("solutions-group");
assert.equal(fieldset.style.borderColor, "red");
```

当 `#other-solution` 被选中且 `#solution-description` 包含至少二十个字符时，`validateForm()["solution-description"]` 应该是 `true`。

```js
document.getElementById("other-solution").checked = true
document.getElementById("solution-description").value = "A sentence with at least twenty characters";
assert.isTrue(validateForm()["solution-description"]);
```

当 `#other-solution` 被选中且 `#solution-description` 包含少于二十个字符时，`validateForm()["solution-description"]` 应该是 `false`。

```js
document.getElementById("other-solution").checked = true
document.getElementById("solution-description").value = "Less than 20 chars";
assert.isFalse(validateForm()["solution-description"]);
```

当 `#other-solution` 被选中且 `#solution-description` 的值更改为有效值时，你应该将其边框颜色设置为 `green`。

```js
document.getElementById("other-solution").checked = true;
const field = document.getElementById("solution-description");
field.value = "A sentence with at least twenty characters"
field.dispatchEvent(new Event("input", { bubbles: true }));
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "green");
```

当 `#other-solution` 被选中且 `#solution-description` 的值更改为无效值时，你应该将其边框颜色设置为 `red`。

```js
document.getElementById("other-solution").checked = true;
const field = document.getElementById("solution-description");
field.value = "Not enough chars"
field.dispatchEvent(new Event("input", { bubbles: true }));
field.dispatchEvent(new Event("change", { bubbles: true }));
assert.equal(field.style.borderColor, "red");
```

你应该有一个名为 `isValid` 的函数。

```js
assert.isFunction(isValid);
```

你的 `isValid` 函数应该以 `validateForm()` 作为参数，当所有表单字段都正确填写时返回 `true`。

```js
document.getElementById("full-name").value = "testing"
document.getElementById("email").value = "example@domain.com"
document.getElementById("order-no").value = "2024001122"
document.getElementById("product-code").value = "Xa22-X123-Xb4"
document.getElementById("quantity").value = "5"
document.getElementById("damaged-product").checked = true
document.getElementById("other-complaint").checked = false
document.getElementById("refund").checked = true
document.getElementById("other-solution").checked = false
assert.isTrue(isValid(validateForm()));

document.getElementById("other-complaint").checked = true
document.getElementById("complaint-description").value = "A sentence with at least twenty characters";
document.getElementById("other-solution").checked = true
document.getElementById("solution-description").value = "A sentence with at least twenty characters";
assert.isTrue(isValid(validateForm()));
```

你的 `isValid` 函数应该以 `validateForm()` 作为参数，当并非所有表单字段都正确填写时返回 `false`。

```js
const name = document.getElementById("full-name");
const email = document.getElementById("email");
const orderNo = document.getElementById("order-no");
const prCode = document.getElementById("product-code");
const quantity = document.getElementById("quantity");
const damaged = document.getElementById("damaged-product");
const nonConforming = document.getElementById("nonconforming-product");
const delayed = document.getElementById("delayed-dispatch");
const otherC = document.getElementById("other-complaint");
const complaintDescr = document.getElementById("complaint-description");
const refund = document.getElementById("refund");
const exchange = document.getElementById("exchange");
const otherS = document.getElementById("other-solution");
const solutionDescr = document.getElementById("solution-description");

// invalid full-name
name.value = "";
email.value = "example@domain.com";
orderNo.value = "2024001122";
prCode.value = "Xa22-X123-Xb4";
quantity.value = "5";
damaged.checked = true;
refund.checked = true;
assert.isFalse(isValid(validateForm()));

// invalid email
name.value = "testing";
email.value = "";
assert.isFalse(isValid(validateForm()));

// invalid order-no
email.value = "example@domain.com";
orderNo.value = "202400";
assert.isFalse(isValid(validateForm()));

// invalid product-code
orderNo.value = "2024001122";
prCode.value = "1a22-Xa23-Xb4";
assert.isFalse(isValid(validateForm()));

// invalid quantity
prCode.value = "Xa22-X123-Xb4";
quantity.value = 0;
assert.isFalse(isValid(validateForm()));

// invalid complaints-group
quantity.value = 5;
damaged.checked = false;
nonConforming.checked = false;
delayed.checked = false;
otherC.checked = false;
assert.isFalse(isValid(validateForm()));

// invalid complaint-description
otherC.checked = true;
complaintDescr.value = "not enough chars";
assert.isFalse(isValid(validateForm()));


// invalid solutions-group
complaintDescr.value = "A sentence with at least twenty characters";
refund.checked = false;
exchange.checked = false;
otherS.checked = false;
assert.isFalse(isValid(validateForm()));

// invalid solutions-description
otherS.checked = true;
solutionDescr.value = "not enough chars";
assert.isFalse(isValid(validateForm()));
```

当你尝试提交表单时，你应该调用 `isValid`。

```js
let flag = false;
const temp = isValid;
try {
    isValid = (obj) => {flag = true};
    document.getElementById("form").dispatchEvent(new Event("submit"));
    assert.isTrue(flag);
} finally {
    isValid = temp;
}
```

# --seed--

## --seed-contents--

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Customer Complaint Form</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h1>Complaint Form</h1>
    <form id="form">
        <fieldset id="personal-info">
            <div>
                <label for="full-name">Full Name:</label>
                <input type="text" id="full-name" name="full-name" placeholder="John Doe">
            </div>

            <div>
                <label for="email">Email Address:</label>
                <input type="email" id="email" name="email" placeholder="example@domain.com">
            </div>
        </fieldset>
        <hr>
        <fieldset id="product-info">
            <div>
                <label for="order-no">Order No:</label>
                <input type="text" id="order-no" name="order-no" placeholder="2024######">
            </div>
            <div>
                <label for="product-code">Product Code:</label>
                <input type="text" id="product-code" name="product-code" placeholder="XX##-X###-XX#">
            </div>
            <div>
                <label for="quantity">Quantity:</label>
                <input type="number" id="quantity" name="quantity" min="1">
            </div>
        </fieldset>

        <fieldset id="complaints-group">
            <legend>Complaint Reason:</legend>
            <div>
                <input type="checkbox" id="damaged-product" name="complaint" value="damaged-product">
                <label for="damaged-product">Damaged Product</label>
            </div>

            <div>
                <input type="checkbox" id="nonconforming-product" name="complaint" value="nonconforming-product">
                <label for="nonconforming-product">Nonconforming Product</label>
            </div>

            <div>
                <input type="checkbox" id="delayed-dispatch" name="complaint" value="delayed-dispatch">
                <label for="delayed-dispatch">Delayed Dispatch</label>
            </div>

            <div>
                <input type="checkbox" id="other-complaint" name="complaint" value="other">
                <label for="other-complaint">Other</label>
            </div>
        </fieldset>

        <fieldset id="complaint-description-container">
            <legend>Description of Complaint Reason</legend>
            <textarea placeholder="Describe the reason of your complaint in at least 20 characters"
                name="complaint-textarea" id="complaint-description"></textarea>
        </fieldset>

        <fieldset id="solutions-group">
            <legend>Desired Solution</legend>
            <input type="radio" name="solutions" id="refund" value="refund">
            <label for="refund">Refund</label>

            <input type="radio" name="solutions" id="exchange" value="exchange">
            <label for="exchange">Exchange</label>

            <input type="radio" name="solutions" id="other-solution" value="other">
            <label for="other-solution">Other</label>
        </fieldset>

        <fieldset id="solution-description-container">
            <legend>Description of Desired Solution</legend>
            <textarea placeholder="Describe the desired solution to your issue in at least 20 characters"
                name="solution-textarea" id="solution-description"></textarea>
        </fieldset>
        <div id="btn-container">
            <button type="submit" id="submit-btn">Submit</button>
            <span id="message-box" aria-live="polite"></span>
        </div>

    </form>

    <script src="script.js">