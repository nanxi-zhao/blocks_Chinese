---
id: 688c9c4fe5fef91262f9bdf8
title: Raise语句是什么，它是如何工作的？
challengeType: 19
dashedName: what-is-the-raise-statement-and-how-does-it-work
---

# --description--

在 Python 中，`raise` 语句是一个强大的工具，允许你在代码中手动触发异常。它让你能够控制何时以及如何产生错误，从而创建自定义的错误条件并强制执行特定的程序行为。

`raise` 用于在程序的任意位置显式抛出异常，用来表示已发生错误或某些前置条件未满足。

Python 中的 `raise` 可以用多种方式触发异常。最基本的用法是抛出内置异常或带自定义信息的异常。下面是一个简单示例：

```py
def check_age(age):
    if age < 0:
        raise ValueError('年龄不能为负数')
    return age

try:
    check_age(-5)
except ValueError as e:
    print(f'错误: {e}') # 错误: 年龄不能为负数
```

在上例中可以看到，`raise` 就是触发异常的关键字。

在该例中，当传入无效年龄时，我们抛出了带自定义信息的 `ValueError`。

`raise` 还可以用于重新抛出当前异常，这在异常处理链中非常有用：

```py
def process_data(data):
    try:
        result = int(data)
        return result * 2
    except ValueError:
        print('日志记录: 接收到无效数据')
        raise  # 重新抛出相同的 ValueError

try:
    process_data('abc')
except ValueError:
    print('在更高层级处理')
```

此处 `raise`（不带参数）用于重新抛出当前正在处理的异常。

这样你就可以在记录日志或做清理工作的同时，将错误继续向上抛出。

你也可以通过定义自定义异常类来抛出自定义异常：

```py
class InsufficientFundsError(Exception):
    def __init__(self, balance, amount):
        self.balance = balance
        self.amount = amount
        super().__init__(f'资金不足: 可用${balance}，请求${amount}')

def withdraw(balance, amount):
    if amount > balance:
        raise InsufficientFundsError(balance, amount)
    return balance - amount

try:
    new_balance = withdraw(100, 150)
except InsufficientFundsError as e:
    print(f'交易失败: {e}')
```

可以看到，自定义异常类通常继承自 `Exception` 或其子类。

你会在后续课程中学习更多关于类与继承的内容。现在只需知道，这是一种用自定义逻辑创建异常的方法。

`raise` 还可以与 `from` 关键字配合使用以实现异常链，用来展示不同错误之间的关联：

```py
def parse_config(filename):
    try:
        with open(filename, 'r') as file:
            data = file.read()
            return int(data)
    except FileNotFoundError:
        raise ValueError('配置文件缺失') from None
    except ValueError as e:
        raise ValueError('配置格式无效') from e

config = parse_config('config.txt')
```

上例中，`raise ... from None` 可以抑制原始异常的上下文：

```bash
Traceback (most recent call last):
  File "main.py", line 12, in <module>
    config = parse_config('config.txt')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "main.py", line 7, in parse_config
    raise ValueError('配置文件缺失') from None
ValueError: 配置文件缺失
```

而 `raise ... from e` 则将新异常与原始异常关联起来，保留错误链路。

```bash
Traceback (most recent call last):
  File "main.py", line 5, in parse_config
    return int(data)
           ^^^^^^^^^
ValueError: invalid literal for int() with base 10: ''

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "main.py", line 12, in <module>
    config = parse_config('config.txt')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "main.py", line 9, in parse_config
    raise ValueError('配置格式无效') from e
ValueError: 配置格式无效
```

你还可以使用 `assert` 来有条件地抛出异常，`assert` 本质上是抛出 `AssertionError` 的简写：

```py
def calculate_square_root(number):
    assert number >= 0, '无法计算负数的平方根'
    return number ** 0.5

try:
    result = calculate_square_root(-4)
except AssertionError as e:
    print(f'断言失败: {e}')
```

`raise` 是构建健壮应用的重要工具，用于强制执行业务规则、验证输入并提供有意义的错误信息。通过策略性地使用 `raise`，你可以让代码更可预测、易调试，并能为用户提供清晰的错误反馈。

# --questions--

## --text--

`raise` 语句在 Python 中有什么作用？

## --answers--

它捕获异常。

### --feedback--

请回到关于抛出异常的章节复习。

---

它会手动触发一个异常。

---

它会忽略错误。

### --feedback--

请回到关于抛出异常的章节复习。

---

它会修复损坏的代码。

### --feedback--

请回到关于抛出异常的章节复习。

## --video-solution--

2

## --text--

当不带任何参数使用 `raise` 时会发生什么？

## --answers--

它会抛出一个通用的 `Exception`。

### --feedback--

请回到关于 `raise` 的章节，理解它在无参数时的行为。

---

它什么也不做。

### --feedback--

请回到关于 `raise` 的章节，理解它在无参数时的行为。

---

它会重新抛出当前异常。

---

它会抛出 `TypeError`。

### --feedback--

请回到关于 `raise` 的章节，理解它在无参数时的行为。

## --video-solution--

3

## --text--

哪个关键字用于将异常串联起来？

## --answers--

`with`

### --feedback--

请回到关于 `raise` 的章节，了解哪个关键字用于连接异常。

---

`from`

---

`chain`

### --feedback--

请回到关于 `raise` 的章节，了解哪个关键字用于连接异常。

---

`link`

### --feedback--

请回到关于 `raise` 的章节，了解哪个关键字用于连接异常。

## --video-solution--

2