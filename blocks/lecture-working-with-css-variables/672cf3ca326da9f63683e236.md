---
id: 672cf3ca326da9f63683e236
title: 什么是 @property 规则，它如何与回退机制一起工作？
challengeType: 19
dashedName: what-is-the-at-property-rule
---

# --interactive--

`@property` 规则是CSS中一个强大的特性，允许开发者定义自定义属性，并更好地控制它们的行为，包括它们如何动画化以及它们的初始值。

这个规则提供了一种增强CSS自定义属性功能的方法，并在它们的应用中提供了更多的灵活性。

`@property` 规则的基本语法如下：

```css
@property --property-name {
  syntax: '<type>';
  inherits: true | false;
  initial-value: <value>;
}
```

`--property-name` 是你正在定义的自定义属性的名称。像所有自定义属性一样，它必须以两个破折号开头。`--property-name` 可以是 `<color>`、`<length>`、`<number>`、`<percentage>` 或更复杂的类型。

`syntax` 定义了属性的类型。

`inherits` 指定属性是否应该从其父元素继承其值。

`initial-value` 设置属性的默认值。

以下是使用 `@property` 规则的实际示例：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css">
<button class="button">点击我</button>
```

```css
@property --main-color {
  syntax: '<color>';
  inherits: false;
  initial-value: #3498db;
}

.button {
  background-color: var(--main-color);
}
```

:::

在这个例子中，我们将自定义属性 `--main-color` 定义为 `color` 值，设置它不继承，并给它一个初始值 `#3498db`。

`@property` 规则的关键优势之一是它允许自定义属性的动画化，这在以前是不可能的：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css">
<div class="gradient-box"></div>
```

```css
@property --gradient-angle {
  syntax: '<angle>';
  inherits: false;
  initial-value: 0deg;
}

.gradient-box {
  width: 100px;
  height: 100px;
  background: linear-gradient(var(--gradient-angle), red, blue);
  transition: --gradient-angle 0.5s;
}

.gradient-box:hover {
  --gradient-angle: 90deg;
}
```

:::

上面的代码创建了一个在元素悬停时平滑动画的渐变，这是使用标准自定义属性无法实现的。

现在，让我们讨论 `@property` 规则如何与回退机制一起工作。

回退机制在CSS中至关重要，以确保在不支持某些特性的浏览器中样式能够优雅地降级。使用 `@property`，回退机制在两个层面起作用：规则本身和自定义属性的使用。

对于不支持 `@property` 规则的浏览器，你可以通过传统方式声明自定义属性来提供回退：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css">
```

```css
:root {
  --main-color: #3498db;
}

@property --main-color {
  syntax: '<color>';
  inherits: false;
  initial-value: #3498db;
}

body {
  background-color: var(--main-color);
}
```

:::

在这种情况下，支持 `@property` 的浏览器将使用更严格定义的版本，而其他浏览器将回退到标准的自定义属性声明。

在使用自定义属性时，你可以使用 `var()` 函数提供回退值，就像使用标准自定义属性一样：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css">
<button class="button">点击我</button>
```

```css
.button {
  background-color: var(--main-color, #3498db);
}
```

:::

这确保了即使 `--main-color` 属性未定义或无效，按钮仍然会有背景颜色。

`@property` 规则还允许更复杂的回退场景。例如，你可以使用它来提供类型安全的回退：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css">
<div class="box">彩色框</div>
```

```css
@property --padding {
  syntax: '<length>';
  inherits: false;
  initial-value: 10px;
}

.box {
  width: 100px;
  height: 100px;
  background-color: darkred;
  color: white;
  padding: var(--padding);
}
```

:::

在这种情况下，如果有人试图将 `--padding` 设置为无效值，比如颜色，浏览器将回退到 `10px` 的初始值，保持类型安全。

值得注意的是，`@property` 规则本身尚未得到普遍支持。截至2023年中期，它在Chrome、Edge和Opera中受支持，Firefox支持需要开启标志。为了更广泛的浏览器支持，提供回退机制并使用特性检测很重要。

总之，`@property` 规则代表了我们在CSS中使用自定义属性方式的重大进步。它提供了更多的控制，并启用了新的可能性，如自定义属性的动画化。但是，重要的是要谨慎使用它，并始终提供适当的回退机制，以确保在所有浏览器中都有良好的体验。与任何前沿的Web技术一样，关键是在支持它的浏览器中增强体验，同时确保不支持它的浏览器的基本功能。

# --questions--

## --text--

CSS中 `@property` 规则的主要目的是什么？

## --answers--

创建新的CSS属性。

### --feedback--

想想 `@property` 如何与自定义CSS属性相关。

---

定义和控制自定义属性的行为。

---

替换标准CSS属性。

### --feedback--

想想 `@property` 如何与自定义CSS属性相关。

---

创建动画。

### --feedback--

想想 `@property` 如何与自定义CSS属性相关。

## --video-solution--

2

## --text--

以下哪项不是 `@property` 规则中的有效描述符？

## --answers--

`syntax`

### --feedback--

考虑 `@property` 规则声明的基本结构。

---

`inherits`

### --feedback--

考虑 `@property` 规则声明的基本结构。

---

`initial-value`

### --feedback--

考虑 `@property` 规则声明的基本结构。

---

`animation`

## --video-solution--

4

## --text--

如何为不支持 `@property` 规则的浏览器提供回退？

## --answers--

使用polyfill。

### --feedback--

想想如何在没有 `@property` 的情况下声明自定义属性。

---

使用标准方法声明自定义属性。

---

使用 `@supports` 规则。

### --feedback--

想想如何在没有 `@property` 的情况下声明自定义属性。

---

不可能提供回退。

### --feedback--

想想如何在没有 `@property` 的情况下声明自定义属性。

## --video-solution--

2