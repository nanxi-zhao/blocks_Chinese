---
id: 67d30191adb999a9909109ef
title: 什么是泛型，它们是如何工作的？
challengeType: 19
dashedName: what-are-generics-and-how-do-they-work
---

# --description--

你实际上在之前的课程中见过泛型类型：`Array<string>`。但你通常会在函数中使用泛型类型。实际上，可以将它们视为提供给函数的特殊参数，用于控制函数类型定义的行为。

让我们回到之前获取数组中随机值的函数示例：

```js
const getRandomValue = (array: string[]): string => {
  return array[Math.floor(Math.random() * array.length)];
}
```

我们的函数接受一个字符串数组并返回一个字符串。但如果我们想传入一个数字数组并返回一个数字呢？

你可以使用联合类型：

```js
const getRandomValue = (array: (string|number)[]): (string|number) => {
  return array[Math.floor(Math.random() * array.length)];
}
const val = getRandomValue([1, 2, 4])
```

但是使用这种方法，即使我们传入的只是一个数字数组，TypeScript 也会确定 `val` 变量可能是一个数字或字符串。

相反，你可以为函数定义一个泛型类型：

```js
const getRandomValue = <T>(array: T[]): T => {
  return array[Math.floor(Math.random() * array.length)];
}
const val = getRandomValue([1, 2, 4])
```

在我们的新示例中有几个重要组成部分。首先，`<T>` 语法告诉 TypeScript 你正在为函数定义一个泛型类型 `T`。`T` 是泛型类型的常用名称，但你实际上可以按任何你喜欢的方式命名它（在 JavaScript 的变量约定范围内）。

然后，我们告诉 TypeScript 数组参数是一个与泛型类型匹配的值数组，并且返回值是同一类型的单个元素。这允许 TypeScript 正确检测到 `val` 将是一个数字，因为我们传递的数组只包含数字。

那我们无法控制的函数呢？让我们来看看 `document.querySelector()` 方法：

```js
const email = document.querySelector("#email");
console.log(email.value);
```

因为我们使用的是 ID 选择器查询，所以 TypeScript 不知道我们正在查询什么类型的元素。它知道它是某种 `Element`，但我们试图访问 `value` 属性会抛出错误，因为顶级元素接口没有该属性。

值得庆幸的是，我们可以向函数调用传递一个类型参数：

```js
const email = document.querySelector<HTMLInputElement>("#email");
console.log(email.value);
```

注意我们如何再次使用尖括号语法（`<HTMLInputElement>`），但这次是在函数调用中。这告诉 TypeScript 我们期望找到的元素将是一个 `input` 元素，由于输入元素确实具有该属性，我们不再在 value 属性上出现错误。当然，如果未找到元素，`querySelector` 可以返回 `null`，而 TypeScript 在这里会抛出编译器错误，因为我们没有处理这种情况。

但你将在下一课中学习到这一点。

# --questions--

## --text--

在函数中定义泛型类型的正确语法是什么？

## --answers--

```ts
function<T>
```

---

```ts
<T>function
```

### --feedback--

泛型类型是在函数参数列表之前使用尖括号定义的。

---

```ts
(T)function
```

### --feedback--

泛型类型是在函数参数列表之前使用尖括号定义的。

---

```ts
function(T)
```

### --feedback--

泛型类型是在函数参数列表之前使用尖括号定义的。

## --video-solution--

1

## --text--

在以下示例中，`T[]` 代表什么？

```ts
const getRandomValue = <T>(array: T[]): T => { ... }
```

## --answers--

任何类型的数组。

### --feedback--

`T` 后面的方括号表示该类型的数组。

---

泛型类型 `T` 的数组。

---

`T` 类型的元组。

### --feedback--

`T` 后面的方括号表示该类型的数组。

---

`T` 类型的单个元素。

### --feedback--

`T` 后面的方括号表示该类型的数组。

## --video-solution--

2

## --text--

调用 `document.querySelector()` 时如何指定类型参数？

## --answers--

```js
document.querySelector("#email", HTMLInputElement)
```

### --feedback--

类型参数是使用函数名称和参数之间的尖括号传递的。

---

```js
document.querySelector("#email"): HTMLInputElement
```

### --feedback--

类型参数是使用函数名称和参数之间的尖括号传递的。

---

```js
document.querySelector<HTMLInputElement>("#email")
```

---

```js
document.querySelector("#email" as HTMLInputElement)
```

### --feedback--

类型参数是使用函数名称和参数之间的尖括号传递的。

## --video-solution--

3