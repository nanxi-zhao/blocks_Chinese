---
id: 673362cbb475e21eab726506
title: 什么是方法链，它是如何工作的？
challengeType: 19
dashedName: what-is-method-chaining-and-how-does-it-work
---

# --interactive--

方法链是一种编程技术，允许你在一行代码中对同一对象调用多个方法。这种技术可以使代码更具可读性和简洁性，特别是在对同一对象执行一系列操作时。

让我们看一个使用不同字符串方法的示例：

:::interactive_editor

```js
const result = "  Hello, World!  "
  .trim()
  .toLowerCase()
  .replace("world", "JavaScript");

console.log(result); // "hello, JavaScript!"
```

:::

在这个示例中，我们从一个字符串开始，并按顺序执行三个操作：修剪空白、转换为小写和将字符串 `world` 替换为 `JavaScript`。每个方法都返回一个新字符串，该字符串成为下一个方法调用的目标。

在处理复杂操作时，方法链可以显著提高代码可读性。

例如，考虑这个使用 `filter`、`map` 和 `reduce` 方法的示例：

:::interactive_editor

```js
const transactions = [
  { amount: 100, type: "credit" },
  { amount: 20, type: "cash" },
  { amount: 150, type: "credit" },
  { amount: 50, type: "cash" },
  { amount: 75, type: "credit" }
];

const totalCreditWithBonus = transactions
  .filter((transaction) => transaction.type === "credit")
  .map((transaction) => transaction.amount * 1.1)
  .reduce((sum, amount) => sum + amount, 0);

console.log(totalCreditWithBonus); // 357.5
```

:::

在这个示例中，我们有一个交易数组，其中每个对象都有一个金额和信用卡或现金类型。

我们首先过滤交易并创建一个仅包含信用卡交易的新数组。然后，我们将 `map` 方法链接到过滤结果，并对每个交易金额乘以 `1.1`，这代表 `10%` 的奖金。

然后，我们获取该结果并将 `reduce` 方法链接起来，将每个金额相加，结果为 `357.5`。

虽然方法链可以使代码更简洁和可读，但明智地使用它很重要。

非常长的链可能难以调试，因为不能立即清楚链中的哪一步可能引起问题。通常最好将非常长的链分解为多个步骤，以获得更好的清晰度和更轻松的调试。

# --questions--

## --text--

以下代码的输出是什么？

```js
let str = "  HELLO world  ";
let result = str.trim().toLowerCase().split(' ');
console.log(result);
```

## --answers--

`["HELLO", "world"]`

### --feedback--

考虑链中每个方法的效果：`trim()`、`toLowerCase()` 和 `split()`。

---

`["hello", "world"]`

---

`"hello world"`

### --feedback--

考虑链中每个方法的效果：`trim()`、`toLowerCase()` 和 `split()`。

---

`[" HELLO", "world "]`

### --feedback--

考虑链中每个方法的效果：`trim()`、`toLowerCase()` 和 `split()`。

## --video-solution--

2

## --text--

在方法链的上下文中，方法通常应该返回什么以允许进一步链接？

## --answers--

`undefined`

### --feedback--

想想什么允许在当前方法之后立即调用链中的下一个方法。

---

`null`

### --feedback--

想想什么允许在当前方法之后立即调用链中的下一个方法。

---

对象本身（`this`）。

---

一个新对象。

### --feedback--

想想什么允许在当前方法之后立即调用链中的下一个方法。

## --video-solution--

3

## --text--

以下代码的结果是什么？

```js
let obj = {
    value: 1,
    increment: function() {
        this.value++;
        return this;
    },
    double: function() {
        this.value *= 2;
        return this;
    },
    getValue: function() {
        return this.value;
    }
};

let result = obj.increment().double().increment().getValue();
console.log(result);
```

## --answers--

`2`

### --feedback--

跟踪方法调用链及其对 `value` 属性的影响。

---

`3`

### --feedback--

跟踪方法调用链及其对 `value` 属性的影响。

---

`4`

### --feedback--

跟踪方法调用链及其对 `value` 属性的影响。

---

`5`

## --video-solution--

4