---
id: 687ea8bb2b781b19c790d00e
title: SQL中的主键和外键是什么，它们是如何工作的？
challengeType: 19
dashedName: what-are-primary-and-foreign-keys-in-sql-and-how-do-they-work
---

# --description--

在SQL中，主键和外键用于建立表格之间的关系。

让我们从主键开始。

主键是唯一标识表格中每个记录（行）的列或列集。此约束确保表格中没有记录对主键具有相同的值。

这就是为什么一个表格只能有一个主键。

主键列中的值也不能为`NULL`，所以它们总是有有效值。

在PostgreSQL中，要使列成为表格的主键，您只需在数据类型后添加`PRIMARY KEY`：

```sql
column_name data_type PRIMARY KEY
```

这是`students`表格的示例：

```sql
CREATE TABLE students (
  student_id SERIAL PRIMARY KEY,
  name VARCHAR(100)
);
```

每个学生都将有自己的`student_id`，这个ID将是表格的主键。`SERIAL`类型在这里很有用，因为它确保`student_id`总是具有唯一值。

复合主键适用于表格没有单个唯一列来标识行的情况。在这种情况下，您可以使用两个或多个列的组合作为主键，它们一起是唯一的。

要做到这一点，在创建表格时指定哪些列是复合主键，如下所示：

```sql
CREATE TABLE table_name (
  column1 data_type column_constraint,
  column2 data_type column_constraint,
  column3 data_type column_constraint,
  ...
  PRIMARY KEY (column1, column2)
);
```

想象您有一个包含`student_id`和`course_id`列的表格，告诉您哪些学生注册了各种课程。

每个学生将注册几门课程，每门课程将有几个学生注册。因此，单独的列都不唯一 - 但您永远不会让同一个学生多次注册同一门课程。因此，您可以使用两列的组合作为主键：

```sql
CREATE TABLE course_enrollments (
  student_id INT,
  course_id INT,
  ...
  PRIMARY KEY (student_id, course_id),
);
```

主键对于确保数据唯一性和完整性、优化数据检索以及在关系数据库中建立与其他表格的关系至关重要。

这让我们进入本课程将涵盖的下一种键：外键。

外键是表格中的列（或列集），它引用另一个表格的主键。一个表格可以有多个外键。

在此示例中，我们有两个表格，`customers`和`orders`：

```sql
CREATE TABLE customers (
  customer_id SERIAL PRIMARY KEY,
  first_name VARCHAR(100) NOT NULL,
  ...
);

CREATE TABLE orders (
  order_id SERIAL PRIMARY KEY,
  customer_id INTEGER,
  ...
  FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
);
```

`customers`表格的主键是`customer_id`，`orders`表格的主键是`order_id`。

但请注意，`orders`表格中也有一个`customer_id`列。

为什么我们要在`orders`表格中存储客户信息？

我们这样做是为了在`customers`和`orders`表格之间创建关系。每个订单将存储提交订单的客户的ID。

为了在表格之间创建关系，我们将使`orders`表格中的`customer_id`列成为引用`customers`表格中`customer_id`列的外键：

```sql
FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
```

外键列中的值必须与被引用表格中的主键值匹配，或者为`NULL`（如果外键允许`NULL`）。

这有什么帮助？

通过确保两个表格中的这些列完全匹配，外键和主键防止创建"孤立"记录，即引用另一个表格中不存在记录的记录。

主键和外键对于关系数据库至关重要。它们驱动这些数据库的"关系"方面，允许您以准确的方式建模现实世界的数据。

# --questions--

## --text--

关系数据库表格中主键的主要目的是什么？

## --answers--

将表格链接到其他表格。

### --feedback--

想想是什么使表格中的每一行都不同。

---

唯一标识表格中的每个记录。

---

定义列的数据类型。

### --feedback--

想想是什么使表格中的每一行都不同。

---

在同一表格中强制执行与外键的关系。

### --feedback--

想想是什么使表格中的每一行都不同。

## --video-solution--

2

## --text--

一个表格中的外键通常引用另一个表格中的哪个键？

## --answers--

另一个外键

### --feedback--

想想被引用表格中的哪个键确保由外键创建的关系的完整性和有效性。

---

唯一索引

### --feedback--

想想被引用表格中的哪个键确保由外键创建的关系的完整性和有效性。

---

主键

---

任何具有相同数据类型的列

### --feedback--

想想被引用表格中的哪个键确保由外键创建的关系的完整性和有效性。

## --video-solution--

3

## --text--

以下哪项是主键的特征？

## --answers--

它可以包含NULL值。

### --feedback--

记住标识每行的独特要求。

---

它可以在同一表格中重复。

### --feedback--

记住标识每行的独特要求。

---

一个表格可以有多个主键。

### --feedback--

记住标识每行的独特要求。

---

它必须包含唯一值。

## --video-solution--

4