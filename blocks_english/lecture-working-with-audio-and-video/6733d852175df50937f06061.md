---
id: 6733d852175df50937f06061
title: 如何使用媒体流从本地设备捕获视频和音频？
challengeType: 19
dashedName: how-can-you-work-with-the-media-streams-getusermedia-to-capture-video-and-audio-from-a-local-device
---

# --description--

除了播放音频和视频，有时你可能想要捕获音频或视频。媒体捕获和流 API，或 MediaStream API，允许你这样做。

然而，要使用 API，你需要创建 `MediaStream` 对象。你可以用构造函数来实现，但它不会与用户的硬件关联。相反，全局 `navigator` 对象的 `mediaDevices` 属性有一个 `getUserMedia()` 方法供你使用。

此方法接受一个定义你想要接收的媒体类型的 `constraints` 对象。该对象有一个 `audio` 和 `video` 属性，分别反映音频和视频流。如果不想接收该类型的流，这些属性可以是 `false`，如果想接收则可以是 `true`，或者是可以定义额外约束的对象。

例如，你可以要求特定的视频输出分辨率：

```js
window.navigator.mediaDevices.getUserMedia({
  audio: true,
  video: {
    width: {
      min: 1280,
      ideal: 1920,
      max: 3840
    },
    height: {
      min: 720,
      ideal: 1080,
      max: 2160
    }
  }
});
```

这个约束对象指定了视频源的最小和最大分辨率。`ideal` 属性指定了你最想要的分辨率——流将提供最接近你理想值的分辨率。

一旦你创建了 MediaStream（假设用户批准了自动请求访问他们的硬件），你可以根据需要使用流数据。

请注意，`getUserMedia()` 返回一个 Promise，这意味着你需要一个回调函数来消费流，或者使用 async/await 语法。你将在未来的课程中了解更多关于 Promise 和异步编程的知识。

下面是一个将用户的网络摄像头源渲染到页面的基本示例。

```js
const video = document.querySelector("video");
const stream =
  await window.navigator.mediaDevices.getUserMedia({ video: true });
video.srcObject = stream;
await video.play();
```

值得注意的是，这个 API 不提供屏幕捕获访问。你将在下一课中学习那个 API。

# --questions--

## --text--

使用哪个方法来访问用户的媒体设备？

## --answers--

`createMediaStream()`

### --feedback--

此方法访问用户的媒体设备。

---

`getMediaDevices()`

### --feedback--

此方法访问用户的媒体设备。

---

`getUserMedia()`

---

`captureStream()`

### --feedback--

此方法访问用户的媒体设备。

## --video-solution--

3

## --text--

在视频的约束对象中，ideal 属性代表什么？

## --answers--

最小可接受的分辨率。

### --feedback--

想想 ideal 这个词的含义。

---

最大可能的分辨率。

### --feedback--

想想 ideal 这个词的含义。

---

首选的分辨率。

---

如果未满足其他约束，则默认分辨率。

### --feedback--

想想 ideal 这个词的含义。

## --video-solution--

3

## --text--

`getUserMedia()` 方法返回什么？

## --answers--

一个 `MediaStream` 对象。

### --feedback--

`getUserMedia()` 方法是异步的。

---

一个 `constraints` 对象。

### --feedback--

`getUserMedia()` 方法是异步的。

---

一个 Promise。

---

一个 `video` 元素。

### --feedback--

`getUserMedia()` 方法是异步的。

## --video-solution--

3