---
id: 6733ffb59c62ee4a23522efe
title: 什么是IndexedDB，它是如何工作的？
challengeType: 19
dashedName: what-is-indexeddb-and-how-does-it-work
---

# --description--

[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)是在浏览器中存储结构化数据的工具。这内置于现代Web浏览器中，允许Web应用程序高效地存储和获取JavaScript对象。

与仅限于存储字符串的其他存储机制（如[localStorage](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ff4a9319c8486750886c.md#L27-L27)）不同，[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)可以存储JavaScript对象、文件以及几乎所有其他类型的数据。这使得需要处理大型和复杂数据结构的Web应用程序变得容易。

现在，让我们看看[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)是如何工作的。

第一步是打开数据库。这是一个示例：

```js
let request = indexedDB.open("Sample DB", 1);

request.onerror = function(event) {
  console.log("Error opening database");
};

request.onsuccess = function(event) {
  let db = event.target.result;
  console.log("Database opened successfully");
};
```

在这段代码中，我们正在打开一个名为["Sample DB"](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L19-L19)的数据库，版本为1。我们提供了两个回调函数：一个用于处理错误，另一个用于数据库成功打开时。在成功回调中获得的[db](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L26-L26)对象是我们用来与数据库交互的对象。

如果您检查浏览器开发工具的应用程序界面，您会在[IndexedDb](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L33-L33)部分看到您的[Sample DB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L19-L19)已被打开。一旦打开了数据库，您就可以开始使用对象存储。

IndexedDB中的对象存储类似于传统数据库中的表。它们保存您想要存储的实际数据。以下是创建对象存储的方法：

```js
request.onupgradeneeded = function(event) {
  let db = event.target.result;
  let objectStore = db.createObjectStore("customers", { keyPath: "id" });
};
```

这段代码创建了一个名为["customers"](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L40-L40)的对象存储，以["id"](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L40-L40)作为其键路径。键路径类似于传统数据库中的主键——它用于唯一标识每条记录。

要向我们的对象存储添加数据，我们会这样做。此示例中的[db](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L26-L26)表示[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)数据库实例。

```js
let transaction = db.transaction(["customers"], "readwrite");
let objectStore = transaction.objectStore("customers");
let request = objectStore.add({ id: 1, name: "John Doe", email: "john@example.com" });

request.onerror = function(event) {
  console.log("Error adding data");
};

request.onsuccess = function(event) {
  console.log("Data added successfully");
};
```

这段代码向我们的["customers"](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L40-L40)对象存储添加了一个新客户。我们启动一个事务（这是我们分组数据库操作的方式），获取对我们对象存储的引用，然后添加我们的数据。

检索数据的工作方式类似。我们启动一个事务，获取我们的对象存储，然后使用像[get](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L69-L69)这样的方法来检索数据：

```js
let transaction = db.transaction(["customers"]);
let objectStore = transaction.objectStore("customers");
let request = objectStore.get(1);

request.onerror = function(event) {
  console.log("Error retrieving data");
};

request.onsuccess = function(event) {
  console.log("Customer:", request.result);
};
```

这段代码从我们的["customers"](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L40-L40)对象存储中检索[id](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L40-L40)为[1](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L51-L51)的客户。

[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)的一个关键特性是它是异步的。

这意味着当您与[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)交互时，操作不会阻塞Web应用程序的主线程。这确保了即使在处理大量数据时，您的Web应用程序仍能保持响应性。

虽然[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)提供了强大的功能，但与其他更简单的存储API选项相比，它的学习曲线更陡峭，这对初学者来说可能具有挑战性。然而，对于需要在客户端处理大量结构化数据的应用程序，[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)提供了无与伦比的功能。

# --questions--

## --text--

[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)操作的关键特征是什么？

## --answers--

它们总是同步的。

### --feedback--

考虑[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)操作如何与Web应用程序的主线程交互。

---

它们总是异步的。

---

它们只适用于字符串数据。

### --feedback--

考虑[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)操作如何与Web应用程序的主线程交互。

---

它们需要持续的互联网连接。

### --feedback--

考虑[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)操作如何与Web应用程序的主线程交互。

## --video-solution--

2

## --text--

使用[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)相比[localStorage](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ff4a9319c8486750886c.md#L27-L27)的主要优势是什么？

## --answers--

[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)更容易使用。

### --feedback--

考虑每种存储方法可以处理的数据类型以及这如何影响它们的使用场景。

---

[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)支持直接存储复杂的JavaScript对象。

---

[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)是同步的。

### --feedback--

考虑每种存储方法可以处理的数据类型以及这如何影响它们的使用场景。

---

[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)在旧版浏览器中受支持。

### --feedback--

考虑每种存储方法可以处理的数据类型以及这如何影响它们的使用场景。

## --video-solution--

2

## --text--

在[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)中，对象存储在传统关系数据库中最类似于什么？

## --answers--

数据库。

### --feedback--

考虑[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)中数据的组织方式与传统SQL数据库的比较。

---

表。

---

行。

### --feedback--

考虑[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)中数据的组织方式与传统SQL数据库的比较。

---

列。

### --feedback--

考虑[IndexedDB](file:///F:/Code/blocks_Chinese/blocks_english/lecture-working-with-client-side-storage-and-crud-operations/6733ffb59c62ee4a23522efe.md#L10-L10)中数据的组织方式与传统SQL数据库的比较。

## --video-solution--

2