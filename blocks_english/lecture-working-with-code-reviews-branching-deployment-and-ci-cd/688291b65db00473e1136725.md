---
id: 688291b65db00473e1136725
title: 什么是 CI/CD，CI 如何与 GitHub Actions 配合工作？
challengeType: 19
dashedName: what-is-ci-cd-and-how-does-ci-work-with-github-actions
---

# --description--

CI 代表持续集成，CD 代表持续交付或持续部署。这些过程允许你在确保更改功能正常后自动部署对应用程序的更改。

在 CI 管道中，你可能对代码运行 linter 和测试。CI 管道通常在拉取请求上运行，以确保所做的更改不会破坏应用程序，也在 `main` 分支上运行，以确保它已准备好部署。

CD 管道也可能在拉取请求上运行，如果你设置了预览环境以便你可以实时查看更改。但你也会在 `main` 分支上运行它，以在更改被接受和合并后持续部署更改。

但这些实际上是如何与 GitHub Actions 配合工作的呢？首先，我们需要了解 GitHub Actions 实际上是什么。GitHub Actions 提供临时运行器（就像临时计算机），允许你执行特定命令。

Actions 用 YAML 文件配置。你可以有多个文件来指定要运行的不同操作。例如，你可能有一个文件用于 CI，另一个用于 CD。

让我们看一个基本的 CI 示例：

```yml
name: Node.js CI
on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  lint:
    name: Lint and Test
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Source Files
        uses: actions/checkout@v4

      - name: Use Node.js v22
        uses: actions/setup-node@v4
        with:
          node-version: 22

      - name: Setup pnpm
        uses: pnpm/action-setup@v2
        with:
          version: 10

      - name: Install Dependencies
        run: pnpm install

      - name: Lint Source Files
        run: pnpm run lint

      - name: Verify Build
        run: pnpm run build

      - name: Run Tests
        run: pnpm run test
```

这很多，所以让我们分解一下。看第一部分：

```yml
name: Node.js CI
on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main
```

`name` 定义操作本身的名称。这出现在 PR 的状态检查部分等区域。`on` 属性定义了所谓的"工作流触发器"——这些是将触发你的操作运行的事件。

在这个例子中，当提交推送到 `main` 时，以及当拉取请求针对 `main` 时，我们运行操作。这意味着当我们发起拉取请求时 CI 运行，当我们合并它时再次运行。

`jobs` 部分是你定义操作实际做什么的地方。`lint:` 键是一个任意键，定义该作业的内部名称。`name` 属性定义此特定作业的外部名称。`runs-on` 属性定义你的操作应该在什么环境中运行——在这种情况下，我们在最新支持的 Ubuntu 版本中运行它。

`steps` 属性是魔法发生的地方。这个块定义了你的操作应该采取的实际步骤。让我们看看那里的第一个块：

```yml
      - name: Checkout Source Files
        uses: actions/checkout@v4
```

这个步骤有两个属性，步骤应该有的 `name`，和一个 `uses` 属性。这个 `uses` 属性是特殊的，它告诉操作运行器去获取 GitHub 上的公共操作并运行它，而不是运行命令。`actions/checkout` 操作处理在你的运行器中克隆和设置仓库。

```yml
      - name: Use Node.js v22
        uses: actions/setup-node@v4
        with:
          node-version: 22

      - name: Setup pnpm
        uses: pnpm/action-setup@v2
        with:
          version: 10
```

接下来的两个块也使用第三方操作。这些步骤设置了 Node 和 pnpm 包管理器。它们都有一个 `with` 键，你可以用它来向那些第三方操作传递参数。把这想象成像向函数传递参数一样。

最后四个块是魔法真正发生的地方。

```yml
      - name: Install Dependencies
        run: pnpm install

      - name: Lint Source Files
        run: pnpm run lint

      - name: Verify Build
        run: pnpm run build

      - name: Run Tests
        run: pnpm run test
```

我们有一个 `Install Dependencies` 块，它安装 npm 包。我们的 `Lint Source Files` 块运行 linter，`Verify Build` 块确保 Typescript 代码可以编译，`Run Tests` 块运行单元测试。

关于操作需要知道的重要一点是，默认情况下，如果这些步骤中的一个失败，剩余的步骤将被跳过，整个运行将被标记为失败。

你的 YAML 文件应该放在哪里才能运行这些操作？它们需要放在仓库中的 `.github/workflows` 目录中，GitHub 才能找到并使用它们。

操作还有很多其他可以做的事情，我鼓励你阅读文档并探索像 MasterPuti 仓库这样的项目中的现有操作。但目前，你应该对 GitHub Actions 和 CI/CD 的基础知识有了不错的理解！

# --questions--

## --text--

GitHub Actions 工作流文件中的 on 属性定义什么？

## --answers--

操作的名称。

### --feedback--

想想你希望操作何时自动运行。

---

触发工作流运行的事件。

---

要运行的操作系统。

### --feedback--

想想你希望操作何时自动运行。

---

要执行的步骤。

### --feedback--

想想你希望操作何时自动运行。

## --video-solution--

2

## --text--

GitHub Actions 工作流 YAML 文件应该放在仓库的哪个位置？

## --answers--

在根目录中。

### --feedback--

GitHub 在特定的目录结构中查找工作流文件。

---

在 `.github/actions` 目录中。

### --feedback--

GitHub 在特定的目录结构中查找工作流文件。

---

在 `.github/workflows` 目录中。

---

在 `workflows` 目录中。

### --feedback--

GitHub 在特定的目录结构中查找工作流文件。

## --video-solution--

3

## --text--

当 GitHub Actions 工作流中的步骤默认失败时会发生什么？

## --answers--

工作流继续并带有警告。

### --feedback--

考虑 GitHub Actions 如何处理工作流执行中的错误。

---

只有该特定步骤被标记为失败。

### --feedback--

考虑 GitHub Actions 如何处理工作流执行中的错误。

---

工作流从头开始重新启动。

### --feedback--

考虑 GitHub Actions 如何处理工作流执行中的错误。

---

剩余步骤被跳过，运行被标记为失败。

## --video-solution--

4