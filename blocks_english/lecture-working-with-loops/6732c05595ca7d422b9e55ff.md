---
id: 6732c05595ca7d422b9e55ff
title: 什么是 For...in 循环，什么时候应该使用它？
challengeType: 19
dashedName: what-is-the-for-in-loop-and-when-should-you-use-it
---

# --interactive--

`for...in` 循环最适合用于遍历对象的属性。此循环将遍历对象的所有可枚举属性，包括继承的属性和非数字属性。

继承的属性是从对象的原型链继承的属性。非数字属性是不为数字或不能转换为数字的字符串的属性。

以下是 `for...in` 循环的基本语法：

```js
for (变量 in 对象) {
  // 要执行的代码块
}
```

示例中的变量表示正在遍历的对象的当前属性。

让我们看几个例子，这样你可以更好地理解 `for...in` 循环的工作原理。

在第一个例子中，我们有一个 `fruit` 对象，我们想要遍历每个属性并将值记录到控制台。

:::interactive_editor

```js
const fruit = {
  name: 'apple',
  color: 'red',
  price: 0.99
};

for (const prop in fruit) {
  console.log(fruit[prop]);
}
```

:::

`prop` 变量表示对象的当前属性。`fruit[prop]` 用于访问每个属性的值。

对于第一次迭代，`prop` 将是 `name`。对于第二次迭代，`prop` 将是 `color`，以此类推。

记录到控制台的结果将是 `apple`、`red` 和 `0.99`。

在第二个例子中，我们有一个嵌套对象，我们想要遍历每个属性并将值记录到控制台。

:::interactive_editor

```js
const person = {
  name: 'John',
  age: 30,
  address: {
    street: '123 Main St',
    city: 'Anytown',
    state: 'CA'
  }
};

for (const prop in person) {
  console.log(person[prop]);
}
```

:::

`address` 属性本身就是一个对象。`for...in` 循环也会遍历 `person` 对象的属性，并将整个 `address` 对象记录到控制台。

以下是控制台中的结果：

```md
John
30
{ street: '123 Main St', city: 'Anytown', state: 'CA' }
```

如果你想遍历 `address` 对象的属性，你可以在第一个循环内部嵌套另一个 `for...in` 循环。

:::interactive_editor

```js
const person = {
  name: 'John',
  age: 30,
  address: {
    street: '123 Main St',
    city: 'Anytown',
    state: 'CA'
  }
};

function isObject(obj) {
  return typeof obj === 'object' && !Array.isArray(obj) && obj !== null;
}

for (const prop in person) {
  if (isObject(person[prop])) {
    for (const nestedProp in person[prop]) {
      console.log(person[prop][nestedProp]);
    }
  } else {
    console.log(person[prop]);
  }
}
```

:::

在这个例子中，我们有一个自定义函数 `isObject`，用于检查值是否为对象。

`Array.isArray` 方法用于检查值是否为数组。通过在方法前放置逻辑非运算符（`!`），我们检查值是否不是数组。

我们不能只使用 `typeof` 等于 `'object'` 的原因是，因为在 JavaScript 中数组也被认为是对象。我们想要排除数组的检查。

此外，由于 JavaScript 中的历史错误，`typeof null` 返回 `'object'`。所以我们也要排除 `null` 值的检查。

如果条件为真，我们嵌套另一个 `for...in` 循环，它将遍历嵌套对象的属性并将值记录到控制台。

`nestedProp` 变量表示嵌套对象的当前属性。

以下是修改后的控制台结果：

```md
"John"
30
"123 Main St"
"Anytown"
"CA"
```

当你需要遍历对象的属性时，`for...in` 循环很有用。

不建议使用 `for...in` 循环来遍历数组的元素。相反，使用 `for...of` 循环或其他数组方法，如 `forEach`、`map`、`filter` 和 `reduce`，你将在未来的课程中学习这些方法。

# --questions--

## --text--

以下代码的输出将是什么？

```js
const fruit = {
  name: 'apple',
  color: 'red',
  price: 0.99
};

for (const prop in fruit) {
  console.log(fruit[prop]);
}
```

## --answers--

```md
apple
apple
apple
```

### --feedback--

回顾课程开头，了解 `for...in` 循环的作用。

---

```md
name
color
price
```

### --feedback--

回顾课程开头，了解 `for...in` 循环的作用。

---

```md
apple
red
0.99
```

---

```md
fruit
fruit
fruit
```

### --feedback--

回顾课程开头，了解 `for...in` 循环的作用。

## --video-solution--

3

## --text--

为什么通常不建议使用 `for...in` 循环来遍历数组的元素？

## --answers--

`for...in` 只遍历数组方法，不遍历元素。

### --feedback--

考虑 `for...in` 可以访问的属性类型和索引。

---

`for...in` 遍历所有可枚举属性，包括继承的属性和非数字属性，这可能导致意外结果。

---

`for...in` 循环相比其他数组迭代方法较慢。

### --feedback--

考虑 `for...in` 可以访问的属性类型和索引。

---

`for...in` 无法处理具有非数字索引的数组。

### --feedback--

考虑 `for...in` 可以访问的属性类型和索引。

## --video-solution--

2

## --text--

嵌套循环示例中为什么需要 `isObject` 函数？

## --answers--

检查值是否为字符串。

### --feedback--

想想检查值是否为对象字面量所需的额外检查。

---

确保值既不是数组也不是 `null`。

---

验证值是否为整数。

### --feedback--

想想检查值是否为对象字面量所需的额外检查。

---

将值转换为对象。

### --feedback--

想想检查值是否为对象字面量所需的额外检查。

## --video-solution--

2