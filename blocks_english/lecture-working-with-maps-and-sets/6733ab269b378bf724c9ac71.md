---
id: 6733ab269b378bf724c9ac71
title: JavaScript 中的 Set 是什么，它与 WeakSet 有何不同？
challengeType: 19
dashedName: what-are-sets-in-javascript-and-how-does-it-differ-from-weaksets
---

# --description--

在 JavaScript 中，`Set` 是用于管理数据集合的内置对象。它允许你存储任何类型的唯一值，无论是原始值还是对象引用。`Set` 确保其中的每个值只出现一次，这使得它在消除数组中的重复项或处理不同值的集合时非常有用。

至于 `WeakSet`，它是一种特殊类型的 `Set`，功能较少，允许你存储弱持有的对象引用和符号。与 `Set` 不同，`WeakSet` 不支持原始值，如数字或字符串。

与常规的 `Set` 不同，`WeakSet` 只存储对象，而对这些对象的引用是"弱"的，这意味着 WeakSet 不会阻止存储的对象被垃圾回收，如果这些对象没有其他引用指向它们。简单来说，如果对象在代码的其他地方没有被使用，它会自动被删除以释放内存。

要创建一个 `Set`，你使用 `Set` 构造函数并将其分配给一个变量：

```js
const myFirstSet = new Set();
```

你也可以用值初始化 `Set`：

```js
const treeSet = new Set(['Baobab', 'Jackalberry', 'Mopane Tree', 'Breadfruit']);
```

如果你将 `Set` 记录到控制台，输出如下所示：

```js
/*
Set(4) {'Baobab', 'Jackalberry', 'Mopane Tree', 'Breadfruit'}
  [[Entries]]
  0: "Baobab"
    value: "Baobab"
  1: "Jackalberry"
    value: "Jackalberry"
  2: "Mopane Tree"
    value: "Mopane Tree"
  3: "Breadfruit"
    value: "Breadfruit"
  size: 4
  [[Prototype]]: Set
*/
```

如果你没有用值初始化 `Set`，你可以使用 `add()` 方法向 `Set` 添加项目：

```js
const treeSet = new Set();

// Add items to the treeSet
treeSet.add('Baobab');
treeSet.add('Jackalberry');
treeSet.add('Mopane Tree');
treeSet.add('Breadfruit');
```

结果和控制台中结果的外观保持不变。

别忘了 `Set` 中的重复项目会被忽略：

```js
const treeSet = new Set();

// Add items to the treeSet
treeSet.add('Baobab');
treeSet.add('Jackalberry');
treeSet.add('Mopane Tree');
treeSet.add('Breadfruit');
treeSet.add('Baobab'); //duplicate item will be ignored

console.log(treeSet);
// Set(4) {'Baobab', 'Jackalberry', 'Mopane Tree', 'Breadfruit'}
```

你可以用来操作 `Set` 的其他方法有：

- `delete()`
- `clear()`
- `has()`
- `entries()`
- `forEach()`
- `keys()`
- `values()`

让我们逐一看看这些方法是如何工作的。`delete()` 从 `Set` 中删除指定的项目：

```js
const treeSet = new Set();

// Add items to the treeSet
treeSet.add('Baobab');
treeSet.add('Jackalberry');
treeSet.add('Mopane Tree');
treeSet.add('Breadfruit');

treeSet.delete('Breadfruit');

console.log(treeSet); // Set(3) {'Baobab', 'Jackalberry', 'Mopane Tree'}
```

`has()` 检查指定的值是否存在于 `Set` 中：

```js
const treeSet = new Set();

// Add items to the treeSet
treeSet.add('Baobab');
treeSet.add('Jackalberry');
treeSet.add('Mopane Tree');
treeSet.add('Breadfruit');

treeSet.delete('Breadfruit');

console.log(treeSet.has('Breadfruit')); // false
```

`entries()` 返回一个 `Set` 迭代器，其中包含 `[value, value]` 格式的值数组：

```js
const treeSet = new Set();

// Add items to the treeSet
treeSet.add('Baobab');
treeSet.add('Jackalberry');
treeSet.add('Mopane Tree');
treeSet.add('Breadfruit');

treeSet.delete('Breadfruit');

console.log(treeSet.entries());
// SetIterator {'Baobab' => 'Baobab', 'Jackalberry' => 'Jackalberry', 'Mopane Tree' => 'Mopane Tree'}
```

`keys()` 和 `values()` 显示 `Set` 中的值。`keys()` 只是 `values()` 方法的别名：

```js
const treeSet = new Set();

// Add items to the treeSet
treeSet.add('Baobab');
treeSet.add('Jackalberry');
treeSet.add('Mopane Tree');
treeSet.add('Breadfruit');

treeSet.delete('Breadfruit');

console.log('Keys: ', treeSet.keys());
console.log('Values: ', treeSet.values());
// Keys: SetIterator {'Baobab', 'Jackalberry', 'Mopane Tree'}
// Values: SetIterator {'Baobab', 'Jackalberry', 'Mopane Tree'}
```

`forEach()` 让你遍历 `Set`：

```js
const treeSet = new Set();

// Add items to the treeSet
treeSet.add('Baobab');
treeSet.add('Jackalberry');
treeSet.add('Mopane Tree');
treeSet.add('Breadfruit');

treeSet.delete('Breadfruit');

treeSet.forEach((tree) => console.log(tree));
/*
Baobab
Jackalberry
Mopane Tree
*/
```

`clear()` 删除数组中的所有项目：

```js
const treeSet = new Set();

// Add items to the treeSet
treeSet.add('Baobab');
treeSet.add('Jackalberry');
treeSet.add('Mopane Tree');
treeSet.add('Breadfruit');

treeSet.delete('Breadfruit');

treeSet.clear();

console.log(treeSet); // Set(0) {size: 0}
```

值得一提的是，还有一个 `size` 属性，它返回 `Set` 中项目的数量：

```js
const treeSet = new Set();

// Add items to the treeSet
treeSet.add('Baobab');
treeSet.add('Jackalberry');
treeSet.add('Mopane Tree');
treeSet.add('Breadfruit');

treeSet.delete('Breadfruit');

console.log(treeSet.size); // 3
```

就像 `Set` 一样，还有一个 `WeakSet` 构造函数可以用来创建 `WeakSet`：

```javascript
const treeWeakSet = new WeakSet();
```

`WeakSet` 也有 `add()`、`delete()` 和 `has()` 方法：

```javascript
const treeWeakSet = new WeakSet();

treeWeakSet.add({ name: 'Baobab' });
treeWeakSet.add({ name: 'Jackalberry' });
treeWeakSet.add({ name: 'Mopane Tree' });
treeWeakSet.add({ name: 'Breadfruit' });

treeWeakSet.delete('Jackalberry');
console.log(treeWeakSet.has('Jackalberry')); // false

console.log(treeWeakSet);
```

在输出中，`WeakSet` 的内容如下所示：

```javascript
/*
WeakSet {{…}, {…}, {…}, {…}}
  [[Entries]]
    No properties
  [[Prototype]]: WeakSet
    .
    .
    .
*/
```

内容显示为空，因为 WeakSet 不可迭代，不直接暴露其内容。

别忘了只支持定义了键和值的符号和对象。添加原始值，如数字或字符串，会导致错误：

```js
treeWeakSet.add('Alan Smith');

console.log(treeWeakSet); // Invalid value used in weak set
//    at WeakSet.add (<anonymous>)
```

`Set` 和 `WeakSet` 的关键区别在于，`Set` 存储任何值，而 `WeakSet` 只能存储对象。

以下是 `Set` 和 `WeakSet` 之间的一些显著区别：

| 特性 | Set | WeakSet |
| ---------------------- | ------------------------------------------------------------------------------- | ---------------------------------------------- |
| 存储的值类型 | 存储任何数据类型 | 只存储对象 |
| 引用 | 强引用 | 弱引用 |
| 迭代 | 支持使用 `forEach` 和循环进行迭代 | 不支持迭代 |
| 方法和属性 | `add()`、`delete()`、`has()`、`keys()`、`values()`、`size` 等 | 只有 `add()`、`delete()` 和 `has()` |
| 使用场景 | 通用的唯一值集合和从数组中删除重复项 | 高效的对象引用内存跟踪 |

你可以看到这两种集合可以存储的值类型、对存储对象进行迭代的支持以及它们的理想使用场景的区别。请花点时间阅读这张表格的内容。

# --questions--

## --text--

`Set` 和 `WeakSet` 在它们支持的数据方面有何不同？

## --answers--

`Set` 允许弱持有的对象引用，而 `WeakSet` 支持对象和原始值。

### --feedback--

记住 `Set` 可以容纳各种数据类型。

---

`Set` 存储任何类型，包括原始值，而 `WeakSet` 只允许弱持有的对象引用。

---

`Set` 的功能比 `WeakSet` 少。

### --feedback--

记住 `Set` 可以容纳各种数据类型。

---

`Set` 专用于对象，而 `WeakSet` 专用于数字。

### --feedback--

记住 `Set` 可以容纳各种数据类型。

## --video-solution--

2

## --text--

如何在 JavaScript 中创建 `Set` 或 `WeakSet`？

## --answers--

通过不带 `new` 关键字调用 `Set()` 或 `WeakSet()`

### --feedback--

想想创建 `Set` 或 `WeakSet` 需要包含什么关键字。

---

通过使用对象字面量 `{}`

### --feedback--

想想创建 `Set` 或 `WeakSet` 需要包含什么关键字。

---

通过使用数组字面量 `[]`

### --feedback--

想想创建 `Set` 或 `WeakSet` 需要包含什么关键字。

---

通过使用带 `new` 关键字的 `Set` 或 `WeakSet` 构造函数

## --video-solution--

4

## --text--

JavaScript 中哪些方法对 `Set` 和 `WeakSet` 都可用？

## --answers--

`keys()`、`values()`、`size()`

### --feedback--

复习课程末尾讨论的内容。

---

`add()`、`delete()`、`has()`

---

`clear()`、`entries()`、`forEach()`

### --feedback--

复习课程末尾讨论的内容。

---

`set()`、`get()`、`remove()`

### --feedback--

复习课程末尾讨论的内容。

## --video-solution--

2