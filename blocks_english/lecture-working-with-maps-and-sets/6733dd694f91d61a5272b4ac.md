---
id: 6733dd694f91d61a5272b4ac
title: Map 对象是什么，它与 WeakMap 有何不同？
challengeType: 19
dashedName: what-is-the-map-object-and-how-does-it-differ-from-weakmaps
---

# --description--

在 JavaScript 中，`Map` 是一个内置对象，用于存储键值对，类似于对象。但是，它与标准 JavaScript 对象的不同之处在于允许任何类型的键，包括对象和函数。

`WeakMap` 是键值对的集合，类似于 `Map`，但它对其键使用弱引用。键必须是对象，而值可以是任何类型。

可以将 `WeakMap` 和 `Map` 之间的关系视为类似于 `WeakSet` 和 `Set` 之间的关系，正如你在上一课中学到的那样。

要创建一个 `Map`，你使用带 `new` 关键字的 `Map()` 构造函数：

```js
const myFirstMap = new Map();
```

你可以用值初始化 Map：

```js
const myTreesMap = new Map([
 [{ type: 'deciduous' }, 'Maple tree'],
 [['forest', 'grove'], 'Pine tree'],
 [42, 'Oak tree'],
 [true, 'Birch tree'],
 [function() { return 'I am a function key'; }, 'Willow tree'],
]);
```

如果你没有用值初始化 `Map`，你可以使用 `set()` 方法添加它们：

```js
const myTreesMap = new Map();
myTreesMap.set({ type: 'deciduous' }, 'Maple tree');
myTreesMap.set([1, 2], 'Pine tree');
myTreesMap.set(42, 'Oak tree');
myTreesMap.set(true, 'Birch tree');
myTreesMap.set(function() { return "I'm a function key"; }, 'Willow tree');

console.log(myTreesMap);
```

以下是控制台中 `Map` 的样子：

```js
/*
Map(5) {{…} => 'Maple tree', Array(2) => 'Pine tree', 42 => 'Oak tree', true => 'Birch tree', ƒ => 'Willow tree'}
  [[Entries]]
    0:{Object => "Maple tree"}
      key: {type: 'deciduous'}
      value: "Maple tree"
    1:{Array(2) => "Pine tree"}
      key: (2)
      value: "Pine tree"
    2:{42 => "Oak tree"}
      key: 42
      value: "Oak tree"
    3:{true => "Birch tree"}
      key: true
      value: "Birch tree"
    4:{function () { return "I'm a function key"; } => "Willow tree"}
      key: f ()
      value: "Willow tree"
    size: 5
    [[Prototype]]: Map
*/
```

你可以用来处理 `Map` 的其他方法有：

- `get(key)` 用于检索与指定 `key` 关联的值。
- `has(key)` 用于检查 `key` 是否存在于 `Map` 中。
- `delete(key)` 用于从 `Map` 中删除键值对。
- `clear()` 用于删除所有键值对。
- `entries()` 用于检查 `Map` 的条目（它以 `MapIterator` 形式返回条目）。
- `forEach()` 用于遍历 `Map` 的条目。
- `size` 用于指示 `Map` 中键值对的数量。

还有一个 `WeakMap()` 构造函数可以用来创建 `WeakMap`：

```js
const myFirstWeakMap = new WeakMap();
```

`set()`、`get()`、`has()` 和 `delete()` 方法也可以与 `WeakMap` 一起使用。例如，以下是使用 `set()` 方法向 `Map` 分配项目的方法：

```js
const myTreeWeakMap = new WeakMap();

myTreeWeakMap.set({ id: 1 }, 'Maple tree');
myTreeWeakMap.set({ id: 2 }, 'Pine tree');
myTreeWeakMap.set({ id: 3 }, 'Oak tree');
myTreeWeakMap.set({ id: 4 }, 'Birch tree');
myTreeWeakMap.set({ id: 5 }, 'Willow tree');

console.log(myTreeWeakMap);
```

以下是控制台中 `WeakMap` 的样子：

```js
/*
WeakMap {{…} => 'Willow tree', {…} => 'Maple tree', {…} => 'Pine tree', {…} => 'Oak tree'}
  [[Entries]]
    No properties
  [[Prototype]]: WeakMap
*/
```

以下是 `Map` 和 `WeakMap` 的区别：

| **特性** | **Map** | **WeakMap** |
| ----------------- | ------------------------------------------------------------------------------------- | ------------------------------------------------------------------ |
| **键类型** | 键可以是任何数据类型，包括字符串、数字、对象甚至函数。 | 键必须是对象。 |
| **使用场景** | 当你需要将数据与任何类型的键关联时使用 `Map`。 | 当你只需要将数据与对象关联时使用 `WeakMap`。 |
| **迭代** | 你可以使用 `forEach()`、`keys()`、`values()` 或 `entries()` 遍历 `Map`。 | `WeakMap` 不可迭代。 |
| **大小属性** | `Map` 有 `size` 属性来获取键值对的数量。 | `WeakMap` 没有 `size` 属性。 |

在上表中，你可以看到总结的区别，包括键类型、使用场景、迭代和大小属性。请花点时间阅读这张表格的内容，了解更多关于它们区别的信息。

# --questions--

## --text--

以下哪项区分了 JavaScript 中的 `Map` 和 `WeakMap`？

## --answers--

`Map` 只允许对象作为键，而 `WeakMap` 允许任何类型的键。

### --feedback--

想想允许的键类型以及引用是如何处理的。

---

`Map` 对键有弱引用，而 `WeakMap` 没有。

### --feedback--

想想允许的键类型以及引用是如何处理的。

---

`Map` 允许任何类型的键，而 `WeakMap` 只允许对象作为键。

---

`Map` 和 `WeakMap` 功能完全相同。

### --feedback--

想想允许的键类型以及引用是如何处理的。

## --video-solution--

3

## --text--

哪个属性让你知道 `Map` 中的项目数量？

## --answers--

`length`

### --feedback--

想想测量 `Map` 中条目数量的属性。

---

`count`

### --feedback--

想想测量 `Map` 中条目数量的属性。

---

`total`

### --feedback--

想想测量 `Map` 中条目数量的属性。

---

`size`

## --video-solution--

4

## --text--

哪个方法让你向 `Map` 和 `WeakMap` 添加项目？

## --answers--

`add()`

### --feedback--

想想专门用于向 `Map` 添加键值对的方法。

---

`push()`

### --feedback--

想想专门用于向 `Map` 添加键值对的方法。

---

`set()`

---

`insert()`

### --feedback--

想想专门用于向 `Map` 添加键值对的方法。

## --video-solution--

3