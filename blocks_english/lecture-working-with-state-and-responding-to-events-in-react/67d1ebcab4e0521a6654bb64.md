---
id: 67d1ebcab4e0521a6654bb64
title: 如何更新状态中的数组？
challengeType: 19
dashedName: how-do-you-update-arrays-in-state
---

# --description--

在React中，更新状态中的数组相当简单，但如果您来自可以直接修改数组的原生JavaScript，很容易犯错误。

在React中，状态被视为不可变的，因此它可以识别更改并正确更新用户界面。

让我们看看如何在React中更新状态中保存的数组。

更新React状态中数组最常见的错误之一是直接使用`push()`、`pop()`或`splice()`等方法修改数组。这些方法会改变原始数组，而React不允许这样做。

React依赖新的数组引用来检测变化，因此直接修改数组可能会阻止组件按预期重新渲染。

以下是使用`push()`方法向状态中的数组添加元素的示例，这种方法不会起作用：

```jsx
import { useState } from "react";

function ItemsList() {
  const [items, setItems] = useState([
    { id: 0, name: "Item 1" },
    { id: 1, name: "Item 2" },
    { id: 2, name: "Item 3" },
  ]);

  const addItem = () => {
    const newItem = { id: items.length + 1, name: `Item ${items.length + 1}` };
    items.push(newItem); // 这会修改原始数组
    setItems(items); // React不会检测到这个变化
  };

  return (
    <div>
      <button onClick={addItem}>Add Item</button>
      <ul>
        {items.map((item) => (
          <li key={item.id}>{item.name}</li>
        ))}
      </ul>
    </div>
  );
}

export default ItemsList;
```

如果您点击`Add Item`按钮，用户界面中不会发生任何事情。

使用`pop()`方法从数组中删除项目也很诱人：

```js
const removeItem = () => {
  items.pop(); // 修改原始数组
  setItems(items); // React也不会检测到这个变化
};
```

要更新状态中的数组，关键是创建一个新数组，执行您的操作，然后将其传递给React，而不是修改现有数组。

因为这是一个新数组，React会知道状态已经改变，并触发重新渲染。

以下是使用展开运算符向`items`数组添加元素的方法：

```js
const addItem = () => {
  const newItem = {
    id: items.length + 1,
    name: `Item ${items.length + 1}`,
  };

  // 创建一个新数组
  setItems((prevItems) => [...prevItems, newItem]);
};
```

`[...prevItems, newItem]`通过复制状态中保存的现有`items`数组中的所有项目来创建一个新数组，然后在末尾添加`newItem`，这会增加`id`和项目编号。

如果您想从数组中删除某些内容，可以使用`filter()`方法，该方法在过滤掉您想要删除的内容后返回一个新数组：

```js
const removeItem = (id) => {
  setItems((prevItems) => prevItems.filter((item) => item.id !== id));
};
```

以下是完整代码：

```jsx
import { useState } from "react";

function ItemsList() {
  const [items, setItems] = useState([
    { id: 0, name: "Item 1" },
    { id: 1, name: "Item 2" },
    { id: 2, name: "Item 3" },
  ]);

  const addItem = () => {
    const newItem = { id: items.length + 1, name: `Item ${items.length + 1}` };
    setItems((prevItems) => [...prevItems, newItem]); // 创建一个新数组
  };

  const removeItem = (id) => {
    setItems((prevItems) => prevItems.filter((item) => item.id !== id)); // 创建一个新数组
  };

  return (
    <div>
      <button onClick={addItem}>Add Item</button>
      <ul>
        {items.map((item) => (
          <li key={item.id}>
            {item.name}{" "}
            <button onClick={() => removeItem(item.id)}>Remove</button>
          </li>
        ))}
      </ul>
    </div>
  );
}

export default ItemsList;
```

这些是更新状态中数组的一些常见方法。

# --questions--

## --text--

以下哪项是更新状态并向数组添加新项目的正确方法？

## --answers--

```js
setItems(copy [prevItems, newItem]);
```

### --feedback--

要更新状态中的数组，您需要使用设置函数和正确的语法向数组添加新项目。

---

```js
setItems(new Array = [...prevItems, newItem]);
```

### --feedback--

要更新状态中的数组，您需要使用设置函数和正确的语法向数组添加新项目。

---

```js
items = (prevItems) => [...prevItems, newItem];
```

### --feedback--

要更新状态中的数组，您需要使用设置函数和正确的语法向数组添加新项目。

---

```js
setItems((prevItems) => [...prevItems, newItem]);
```

## --video-solution--

4

## --text--

为什么不应该直接修改React状态中的数组？

## --answers--

它会自动清空数组。

### --feedback--

React依赖不可变性来检测状态中的变化。

---

它会向数组中添加不需要的重复项。

### --feedback--

React依赖不可变性来检测状态中的变化。

---

它会在组件中引起错误。

### --feedback--

React依赖不可变性来检测状态中的变化。

---

它会阻止React检测变化。

## --video-solution--

4

## --text--

从React状态中的数组中删除项目的最佳方法是什么？

## --answers--

`splice()`

### --feedback--

想想创建一个新数组而不修改原始数组的方法。

---

`push()`

### --feedback--

想想创建一个新数组而不修改原始数组的方法。

---

`pop()`

### --feedback--

想想创建一个新数组而不修改原始数组的方法。

---

`filter()`

## --video-solution--

4